<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BATI DC</title>
  <style>
    :root{
      --bg:#f6f7f9;--ink:#0b0b0c;--muted:#6b7280;--accent:#f59e0b;--dark:#0f1115;
      --card:#fff;--border:#e5e7eb;--ok:#10b981;--err:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font:15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Arial;background:var(--bg);color:var(--ink)}

    /* App bar */
    .appbar{position:sticky;top:0;z-index:30;background:var(--dark);color:#fff;border-bottom:1px solid #1f2937}
    .bar{max-width:1100px;margin:auto;padding:14px;display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center}
    .brand{font-weight:900;letter-spacing:.3px;font-size:28px} /* BATI DC un peu plus grand */
    .icons{display:flex;gap:10px}
    .iconbtn{width:40px;height:40px;border-radius:12px;background:transparent;border:2px solid #374151;display:grid;place-items:center;color:#fff;cursor:pointer}
    .searchrow{max-width:1100px;margin:0 auto 10px;padding:0 14px}
    .searchbox{display:grid;grid-template-columns:1fr auto;gap:12px}
    .input{height:48px;border-radius:24px;border:2px solid #374151;background:#0d1116;color:#e5e7eb;padding:0 18px}
    .cta{height:48px;padding:0 18px;border:0;border-radius:24px;background:var(--accent);color:#111;font-weight:800;cursor:pointer}

    .tabs-wrap{background:#fff;border-top:1px solid #e5e7eb;border-bottom:1px solid #e5e7eb;position:sticky;top:96px;z-index:25}
    .tabs{max-width:1100px;margin:auto;padding:10px 14px;display:flex;gap:10px;overflow:auto}
    .tab{padding:10px 16px;border:2px solid var(--border);border-radius:12px;background:#fff;font-weight:700;text-decoration:none;color:inherit;white-space:nowrap}
    .tab_active{background:#111;color:#fff;border-color:#111}

    .notice{max-width:1100px;margin:14px auto 0;padding:12px 14px;background:#fff;border:1px solid var(--border);border-radius:14px;display:flex;gap:10px;align-items:center}

    /* Cards */
    .wrap{max-width:1100px;margin:12px auto;padding:0 14px;display:grid;gap:16px}
    .section-title{font-size:28px;font-weight:900}

    .card{background:var(--card);border:1px solid var(--border);border-radius:20px;overflow:hidden}
    .hero{aspect-ratio:16/9;background:#e5e7eb}
    .pad{padding:16px}
    .product-title{font:800 22px/1.2 system-ui;margin:0 0 6px}
    .meta{color:#6b7280;margin-bottom:8px}
    .price{font:800 22px/1.1 system-ui;margin:12px 0}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .btn{height:44px;padding:0 16px;border-radius:12px;border:2px solid #111;font-weight:800;cursor:pointer;background:#111;color:#fff}
    .btn.alt{background:#fff;color:#111;border-color:#111}
    .right{margin-left:auto}

    /* Auth Panel */
    dialog{border:0;border-radius:18px;padding:0;max-width:440px;width:calc(100% - 24px)}
    .dlg-head{padding:14px 16px;background:#111;color:#fff;border-radius:18px 18px 0 0;display:flex;justify-content:space-between;align-items:center}
    .dlg-body{padding:16px;background:#fff}
    .fld{display:grid;gap:6px;margin-bottom:12px}
    input[type="email"],input[type="password"]{height:44px;border-radius:10px;border:1.5px solid var(--border);padding:0 12px}
    .small{font-size:12px;color:var(--muted)}
    .alert{padding:10px;border-radius:10px;margin-bottom:10px;display:none}
    .alert.ok{background:#ecfdf5;color:#064e3b;border:1px solid #a7f3d0}
    .alert.err{background:#fef2f2;color:#7f1d1d;border:1px solid #fecaca}
    .link{color:#2563eb;text-decoration:underline;cursor:pointer}

    /* Status badge */
    #fb-badge{position:fixed;right:12px;bottom:12px;background:#111;color:#fff;padding:10px 14px;border-radius:14px;font:600 14px system-ui;z-index:999;opacity:.95;display:none}
  </style>
</head>
<body>
  <!-- App bar -->
  <div class="appbar">
    <div class="bar">
      <button class="iconbtn" id="menuBtn">‚â°</button>
      <div class="brand">BATI DC</div>
      <div class="icons">
        <button class="iconbtn" id="accountBtn">üë§</button>
        <button class="iconbtn" id="ordersBtn">üßæ</button>
        <button class="iconbtn" id="cartBtn">üõí</button>
      </div>
    </div>
    <div class="searchrow">
      <div class="searchbox">
        <input id="q" class="input" placeholder="Rechercher : perceuse, b√©ton, EPI‚Ä¶" />
        <button class="cta">Rechercher</button>
      </div>
    </div>
  </div>

  <!-- Onglets -->
  <div class="tabs-wrap">
    <div class="tabs">
      <a class="tab tab_active">Accueil</a>
      <a class="tab">Produits</a>
      <a class="tab">Fournisseurs</a>
      <a class="tab">Services</a>
    </div>
  </div>

  <!-- Notice -->
  <div class="notice">üì¶ <b>Livraison partout en France</b></div>

  <!-- Contenu -->
  <div class="wrap">
    <div class="section-title">Serrurerie</div>

    <article class="card">
      <div class="hero" id="hero1" role="img" aria-label="visuel produit"></div>
      <div class="pad">
        <div class="meta">Heracles ‚Ä¢ r√©f. Y7C+ 30/30</div>
        <h3 class="product-title">Cylindre de serrure Y7C+ A2P 30x30 (5 cl√©s)</h3>
        <p class="small">Cylindre europ√©en Y7C+ certifi√© A2P ‚Äì corps laiton, s√©curit√© renforc√©e, anticrottage.</p>
        <div class="row">
          <div class="price">√Ä partir de 69,90 ‚Ç¨</div>
          <button class="btn right" id="btnAddToQuote">Ajouter au devis</button>
          <button class="btn alt" id="btnSeePrices">Voir les prix</button>
        </div>
      </div>
    </article>
  </div>

  <!-- Auth dialog -->
  <dialog id="authDlg">
    <div class="dlg-head">
      <div>Compte professionnel</div>
      <button class="iconbtn" id="closeAuth" style="border-color:#374151">‚úï</button>
    </div>
    <div class="dlg-body">
      <div class="alert ok" id="okMsg"></div>
      <div class="alert err" id="errMsg"></div>

      <div class="fld">
        <label>Email</label>
        <input type="email" id="email" placeholder="ex: pro@entreprise.fr" autocomplete="email" />
      </div>
      <div class="fld">
        <label>Mot de passe</label>
        <input type="password" id="pwd" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" />
      </div>

      <div class="row" style="justify-content:space-between;margin:12px 0">
        <button class="btn" id="btnLogin">Se connecter</button>
        <button class="btn alt" id="btnSignup">Cr√©er un compte</button>
      </div>
      <div class="small">
        Mot de passe perdu ? <span class="link" id="btnReset">R√©initialiser</span>
      </div>

      <hr style="margin:16px 0;border:0;border-top:1px solid var(--border)">
      <div class="small">
        Statut : <b id="authState">non connect√©</b> ‚Ä¢
        <span class="link" id="btnLogout" style="display:none">Se d√©connecter</span>
      </div>
    </div>
  </dialog>

  <!-- Badge statut Firebase -->
  <div id="fb-badge">Firebase : <span id="fb-status">connexion‚Ä¶</span></div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getAuth, setPersistence, browserLocalPersistence,
      onAuthStateChanged, createUserWithEmailAndPassword,
      signInWithEmailAndPassword, sendPasswordResetEmail, signOut
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    /* ---------- CONFIG √Ä PERSONNALISER (mets juste ta apiKey) ---------- */
    const firebaseConfig = {
      apiKey: "AIzaSyBD4M0HxtjmNUvLjyex2WBeY2iiw7BDSgw",        // <= remplace uniquement ceci
      authDomain: "bati-dc.firebaseapp.com",
      projectId: "bati-dc",
      storageBucket: "bati-dc.appspot.com",
      messagingSenderId: "223128606936",
      appId: "1:223128606936:web:944577b9fe9c0c93419fad"
    };
    /* ------------------------------------------------------------------- */

    // UI helpers
    const $ = sel => document.querySelector(sel);
    const badge = $('#fb-badge'), status = $('#fb-status');
    const showBadge = t => { badge.style.display='inline-flex'; status.textContent=t; };
    const okMsg = $('#okMsg'), errMsg = $('#errMsg');
    const showOK  = t => { okMsg.textContent=t; okMsg.style.display='block'; errMsg.style.display='none'; };
    const showERR = t => { errMsg.textContent=t; errMsg.style.display='block'; okMsg.style.display='none'; };

    // Init Firebase
    let auth;
    try {
      const app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      await setPersistence(auth, browserLocalPersistence);
      showBadge('connect√©');
    } catch (e) {
      console.error(e);
      showBadge('erreur');
    }

    // Auth dialog open/close
    const dlg = $('#authDlg');
    $('#accountBtn').addEventListener('click', ()=> dlg.showModal());
    $('#closeAuth').addEventListener('click', ()=> { dlg.close(); okMsg.style.display='none'; errMsg.style.display='none'; });

    // Buttons
    $('#btnSignup').addEventListener('click', async ()=>{
      const email = $('#email').value.trim();
      const pwd   = $('#pwd').value;
      if(!email || !pwd) return showERR('Renseigne email et mot de passe.');
      try{
        await createUserWithEmailAndPassword(auth, email, pwd);
        showOK('Compte cr√©√©, vous √™tes connect√©.');
      }catch(e){
        showERR(mapAuthError(e));
      }
    });

    $('#btnLogin').addEventListener('click', async ()=>{
      const email = $('#email').value.trim();
      const pwd   = $('#pwd').value;
      if(!email || !pwd) return showERR('Renseigne email et mot de passe.');
      try{
        await signInWithEmailAndPassword(auth, email, pwd);
        showOK('Connexion r√©ussie.');
      }catch(e){
        showERR(mapAuthError(e));
      }
    });

    $('#btnReset').addEventListener('click', async ()=>{
      const email = $('#email').value.trim();
      if(!email) return showERR('Entre ton email pour recevoir le lien.');
      try{
        await sendPasswordResetEmail(auth, email);
        showOK('Email de r√©initialisation envoy√©.');
      }catch(e){
        showERR(mapAuthError(e));
      }
    });

    $('#btnLogout').addEventListener('click', async ()=>{
      try{ await signOut(auth); }catch(e){ console.error(e); }
    });

    // Listen auth state
    onAuthStateChanged(auth, user=>{
      const a = $('#authState'), lo = $('#btnLogout');
      if(user){
        a.textContent = `connect√© (${user.email})`;
        lo.style.display = 'inline';
      }else{
        a.textContent = 'non connect√©';
        lo.style.display = 'none';
      }
    });

    // Basic demo actions
    $('#btnAddToQuote').addEventListener('click', ()=> alert('Ajout√© au devis (d√©mo).'));
    $('#btnSeePrices').addEventListener('click', ()=> alert('Page prix / fiche article (d√©mo).'));

    // Map Firebase errors -> FR
    function mapAuthError(e){
      const c = e.code || '';
      if(c.includes('email-already-in-use')) return "Cet email est d√©j√† utilis√©.";
      if(c.includes('invalid-email')) return "Email invalide.";
      if(c.includes('weak-password')) return "Mot de passe trop court (min 6).";
      if(c.includes('wrong-password')) return "Mot de passe incorrect.";
      if(c.includes('user-not-found')) return "Aucun compte avec cet email.";
      if(c.includes('too-many-requests')) return "Trop de tentatives. R√©essaie plus tard.";
      return "Erreur : " + (e.message || c);
    }

    // Petite image de d√©mo pour la carte
    const demoImg = "https://images.unsplash.com/photo-1519681393784-d120267933ba?w=1200&auto=format&fit=crop&q=60";
    const hero = document.getElementById('hero1');
    hero.style.background = `center/cover no-repeat url('${demoImg}')`;
  </script>
</body>
</html>
